<div dir="rtl">
# سیستم احراز هویت با شماره تلفن

این پروژه یک سیستم احراز هویت مبتنی بر شماره تلفن همراه است که با استفاده از Django و Django REST Framework پیاده‌سازی شده است.

## ویژگی‌های کلیدی

- **احراز هویت با شماره تلفن**: کاربران با شماره تلفن همراه ایرانی (با فرمت +989) ثبت‌نام و وارد می‌شوند.
- **امنیت بالا**:
  - محدودیت تعداد درخواست‌ها (rate limiting)
  - سیستم مسدودسازی پس از چندین تلاش ناموفق
  - استفاده از رمزهای عبور پیچیده
- **کد تأیید یکبار مصرف (OTP)**: ارسال کد ۶ رقمی برای تأیید شماره تلفن
- **توکن‌های JWT**: برای احراز هویت کاربران پس از ورود

## اجزای اصلی سیستم

### مدل کاربری (CustomUser)
- استفاده از شماره تلفن به عنوان شناسه اصلی کاربر
- ذخیره اطلاعات پایه کاربر (نام، نام خانوادگی، ایمیل)
- مدیریت سطح دسترسی‌ها (کاربر عادی، ادمین)

### سرویس‌های اصلی

1. **BlockService**:
   - مدیریت مسدودسازی کاربران پس از چندین تلاش ناموفق
   - محدودیت ۳ تلاش برای ورود یا ثبت‌نام
   - مسدودسازی ۱ ساعته پس از تلاش‌های ناموفق


2. **OTPService**:
   - تولید و ارسال کد تأیید ۶ رقمی
   - اعتبارسنجی کدهای ارسال شده
   - استفاده از قفل (Lock) برای جلوگیری از حملات همزمان


3. **UserManager**:
   - مدیریت ایجاد کاربران عادی و ادمین
   - اعتبارسنجی اطلاعات ورودی

### اندپوینت‌های API

1. **بررسی شماره تلفن**:
   - `POST /api/user/'phone-number/check/`:
   - بررسی ثبت‌نام بودن یا نبودن کاربر
   - بررسی وضعیت مسدود بودن
   - ارسال کد OTP برای کاربران جدید


2. **ورود کاربر**:
   - `POST /api/user/login/`:
   - احراز هویت با شماره تلفن و رمز عبور
   - برگرداندن توکن‌های JWT
   - مدیریت تلاش‌های ناموفق


3. **ثبت‌نام کاربر**:
   - `POST /api/auth/register/`:
   - تأیید کد OTP
   - ایجاد پروفایل کاربری
   - تنظیم رمز عبور

## تست‌ها

سیستم به طور کامل تست شده است، شامل:

- تست‌های مدل کاربری
- تست سرویس‌های Block و OTP
- تست اندپوینت‌های API
- تست سناریوهای خطا و موارد مرزی

## فناوری‌های استفاده شده

- Django و Django REST Framework
- Redis برای کش و مدیریت قفل‌ها
- Celery برای ارسال ناهمزمان کدهای تأیید
- JWT برای احراز هویت
- سیستم لاگ‌گیری پیشرفته

## نکات ایمنی

- اعتبارسنجی شماره تلفن با فرمت صحیح ایرانی
- اعتبارسنجی رمز عبور (حداقل ۸ کاراکتر، شامل حرف و عدد)
- استفاده از قفل برای جلوگیری از حملات همزمان
- محدودیت نرخ درخواست‌ها
- مسدودسازی پس از چندین تلاش ناموفق

این پروژه به گونه‌ای طراحی شده که به راحتی قابل گسترش و یکپارچه‌سازی با سایر سیستم‌ها باشد.

## معماری و طراحی امن

**۱. تفکیک محیط‌های اجرایی**

تقسیم‌بندی هوشمند محیط‌ها:

محیط توسعه (Development) با قابلیت‌های دیباگ پیشرفته

محیط تولید (Production) با تنظیمات امنیتی سخت‌گیرانه

استفاده از متغیرهای محیطی برای مدیریت تفاوت‌های بین محیطی


******۲. ملاحظات امنیتی پیشرفته
مدیریت هوشمند کش و دیتابیس:******

طراحی اولیه شامل امکان استفاده از سیستم‌های کش (Redis) و پایگاه‌داده‌های توزیع‌شده بود

ساده‌سازی عمدی: به منظور تمرکز بر منطق اصلی و خوانایی کد، از پیاده‌سازی این بخش‌ها صرف‌نظر شد

قابلیت ارتقا به معماری پیشرفته‌تر بدون نیاز به بازنویسی اساسی

**۳. طراحی کنترل‌کننده‌ها
انتخاب آگاهانه APIView:**

هدف: نمایش شفاف و دقیق منطق کسب‌وکار

مزیت: کنترل کامل بر فرآیند پردازش درخواست‌ها

امکان ردیابی آسان جریان داده‌ها در هر مرحله

**۴. معماری منطق کسب‌وکار
تمرکز بر اصول SOLID:**

پیاده‌سازی منطق اصلی در لایه View برای وضوح بیشتر

امکان تفکیک آسان به لایه‌های مجزا در آینده

طراحی ماژولار برای توسعه پذیری

**۵. بهینه‌سازی‌های عملکردی
مدیریت هوشمند درخواست‌ها:**

سیستم محدودسازی نرخ (Rate Limiting) یکپارچه

مکانیزم مسدودسازی هوشمند پس از چندین تلاش ناموفق

بهینه‌سازی فرآیند احراز هویت با کمترین تاخیر
</div>